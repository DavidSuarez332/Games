<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trivia and Triumph ‚Äî Play to Win!</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <style>
    :root{
      --bg1:#08122a;--bg2:#071428;--card:#071428;--accent1:#06b6d4;--accent2:#7c3aed;--accent3:#ff7a18;--good:#10b981;--bad:#ef4444;
      --bright1:#ffd60a;--bright2:#ff5c93;
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#e6eef8;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .wrap{width:100%;max-width:1240px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));border-radius:18px;padding:20px;box-shadow:0 12px 48px rgba(2,6,23,.6);border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;align-items:center;gap:14px}
    h1{margin:0;font-size:24px;line-height:1.05}
    .subtitle{opacity:.95;margin-top:6px;color:#dff5ff}
    .qbox{margin-top:16px;padding:16px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02)}
    #question{font-size:18px;margin-bottom:10px}
    .input-row{display:flex;gap:8px}
    input[type='text']{flex:1;padding:10px;border-radius:10px;border:0;background:rgba(255,255,255,0.03);color:inherit;font-size:15px}
    button{border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700;letter-spacing:0.2px}
    .btn-primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;box-shadow:0 6px 18px rgba(6,182,212,0.12)}
    .btn-accent{background:linear-gradient(90deg,var(--accent3),#f43f5e);color:white}
    .hint-btn{background:linear-gradient(90deg,#f59e0b,#f97316);color:#061123}
    .secondary{background:rgba(255,255,255,0.03);color:inherit}
    .status{margin-top:10px;font-size:15px;min-height:1.4em}
    .answerReveal{margin-top:10px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.35);color:#fff;display:none}
    .deal-box{margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(90deg,rgba(124,58,237,0.12),rgba(6,182,212,0.06));display:flex;align-items:center;justify-content:space-between}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:14px;font-size:13px}
    .progress{height:12px;background:rgba(255,255,255,0.04);border-radius:999px;overflow:hidden;flex:1;margin-left:12px}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent1),var(--accent2));width:0%}
    .money{font-weight:800;color:var(--accent3)}
    .confetti{position:fixed;left:0;top:0;pointer-events:none;width:100%;height:100%;overflow:hidden;z-index:70}
    .confetti span{position:absolute;font-size:24px;animation:fall 2800ms linear forwards}
    @keyframes fall{0%{transform:translateY(-10vh) rotate(0deg);opacity:1}100%{transform:translateY(110vh) rotate(360deg);opacity:0}}
    .start-overlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(2,6,23,0.6),rgba(2,6,23,0.85));display:flex;align-items:center;justify-content:center;z-index:100}
    .start-card{background:linear-gradient(180deg,#061126,#071428);padding:28px;border-radius:16px;text-align:center;max-width:640px;border:1px solid rgba(255,255,255,0.03)}
    .brand{font-weight:900;color:var(--accent2)}
    .family{display:flex;flex-direction:column;gap:10px}
    .bubble{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:10px;border-radius:10px;border-left:4px solid rgba(255,255,255,0.04)}
    .bubble strong{display:block;margin-bottom:6px}
    .restart{margin-top:12px;background:linear-gradient(90deg,#06b6d4,#7c3aed);padding:12px;border-radius:10px;color:white;font-weight:800;width:100%}
    .chart-wrap{height:200px}
    .host-panel{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));margin-bottom:12px}
    .host-emoji{font-size:36px}
    .host-text{font-weight:700}
    .lights{position:absolute;inset:0;pointer-events:none;mix-blend-mode:screen;opacity:0.95}
    .light-strip{position:absolute;height:40px;left:0;right:0;top:0;background:linear-gradient(90deg,var(--bright1),var(--bright2));filter:blur(18px);opacity:0.06;animation:flash 1800ms linear infinite}
    .light-strip.bottom{top:auto;bottom:0;animation-duration:2100ms}
    @keyframes flash{0%{opacity:0.02}50%{opacity:0.18}100%{opacity:0.02}}
    .phone-choices{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .small{font-size:12px;opacity:.85}
    .host-dialog{margin-top:8px;padding:8px;border-radius:8px;background:linear-gradient(180deg,rgba(0,0,0,0.25),rgba(0,0,0,0.15));color:#fff}
    .animated-glow{box-shadow:0 8px 30px rgba(124,58,237,0.12);transition:all .18s ease}
    .bright-btn{background:linear-gradient(90deg,var(--bright1),var(--bright2));color:#061123;font-weight:800}
    @media (max-width:980px){.grid{grid-template-columns:1fr}.chart-wrap{height:180px}}
  </style>
</head>
<body>
  <div class="lights" aria-hidden="true">
    <div class="light-strip"></div>
    <div class="light-strip bottom" style="animation-delay:.4s"></div>
  </div>
  <div class="confetti" id="confetti"></div>

  <div class="wrap">
    <div class="grid">
      <div class="card animated-glow">
        <header>
          <div style="font-size:44px">üéØ</div>
          <div>
            <h1>üéØ <span class="brand">Trivia and Triumph</span> üèÜ</h1>
            <div class="subtitle">10-question run ‚Ä¢ dynamic difficulty ‚Ä¢ Phone-a-Friend ‚Ä¢ Retry x1 ‚Ä¢ Bright host & family interaction</div>
          </div>
        </header>

        <div class="qbox">
          <div id="qnum"></div>

          <div class="host-panel" id="hostPanel" role="region" aria-live="polite">
            <div class="host-emoji">üï¥Ô∏è</div>
            <div>
              <div class="host-text" id="hostLine">Hello! I'm your host ‚Äî ready when you are.</div>
              <div class="small" id="hostSub">I will cheer, prod, and tempt your choices.</div>
            </div>
          </div>

          <div id="question">Press Start to begin</div>

          <div class="input-row" style="margin-top:8px">
            <input id="answerInput" type="text" placeholder="type your answer here in lowercase" disabled />
            <button id="submitBtn" class="btn-primary" disabled>Submit ‚úÖ</button>
            <button id="hintBtn" class="hint-btn">Hint üí° (<span id="hintsLeft">2</span>)</button>
            <button id="retryBtn" class="bright-btn">Retry üîÅ (<span id="retriesLeft">1</span>)</button>
            <button id="phoneBtn" class="secondary">Phone-a-Friend üìû</button>
          </div>

          <div id="phoneArea" style="display:none" class="small">
            <div style="margin-top:10px">Who do you call?</div>
            <div class="phone-choices" id="phoneChoices"></div>
            <div id="phoneResponse" class="host-dialog" style="display:none"></div>
          </div>

          <div class="status" id="status"></div>

          <div id="dealArea" style="display:none">
            <div class="deal-box">
              <div id="dealText"></div>
              <div>
                <button id="dealBtn" class="btn-accent">Deal üí∞</button>
                <button id="noDealBtn" class="secondary">No Deal ‚úñÔ∏è</button>
              </div>
            </div>
          </div>

          <div id="answerReveal" class="answerReveal"></div>

          <div style="margin-top:12px;display:flex;gap:10px;align-items:center">
            <div style="flex:1">
              <div class="progress" aria-hidden="true"><i id="progressBar"></i></div>
            </div>
            <div style="min-width:260px;text-align:right">Question <span id="current">0</span> / 10 &nbsp; | &nbsp; Correct: <span id="correctCount">0</span></div>
          </div>

          <div class="footer">
            <div class="small">Potential prize now: <span class="money" id="currentPrize">$0</span></div>
            <div><button id="restartBtn" class="restart" style="display:none">Restart Game ‚Ü∫</button></div>
          </div>

        </div>
      </div>

      <aside>
        <div class="card">
          <h3 style="margin:0 0 8px">Host & Family</h3>

          <div id="familyHostWrap">
            <div id="familyPanel" class="family"></div>
          </div>

          <div style="margin-top:12px">
            <strong>Prize Progress</strong>
            <div class="chart-wrap">
              <canvas id="prizeChart"></canvas>
            </div>
          </div>

          <div style="margin-top:10px;font-size:12px;opacity:.95">Tip: Between Q5‚ÄìQ8 the host may tempt you with a buyout ‚Äî think fast.</div>
        </div>
      </aside>
    </div>
  </div>

  <div class="start-overlay" id="startOverlay">
    <div class="start-card">
      <h2 style="margin:0 0 8px">Welcome to <span class="brand">Trivia and Triumph</span> üé≤</h2>
      <p style="margin:0 0 12px">Click Start to enable sounds and begin. Use Restart if you want to play again at any time.</p>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
        <button id="startBtn" class="btn-primary">Start Game ‚ñ∂Ô∏è</button>
        <button id="viewRules" class="secondary">View Rules</button>
      </div>
      <div class="small" style="margin-top:12px">To publish on GitHub Pages root, name file <code>index.html</code>.</div>
    </div>
  </div>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// ----------------------------
// Trivia and Triumph ‚Äî Full game (250 Qs generated + curated)
// ----------------------------

// ---------- CORE STATE ----------
let questions = [], currentIndex=0, correctCount=0, hintsLeft=2, retriesLeft=1, usedPhone = false, gameOver=false;
let audioCtx = null; let prizeProgress = [];

// ---------- PRIZE MAP ----------
const PRIZE_MAP = {
  0:0,1:1000,2:3500,3:5750,4:8250,5:14000,6:20000,7:50000,8:120000,9:190500,10:500000
};

// ---------- HOST LINES ----------
const HOST_LINES = [
  "You're on the hot seat ‚Äî ready to shine? üíº",
  "What would YOU do with the money? Dream big!",
  "Are you feeling confident? I believe in you!",
  "You're the best ‚Äî show us what you've got!",
  "Nice! Keep that energy going!",
  "Ooo, big question coming ‚Äî steady hands!",
  "That was close... breathe and focus.",
  "Imagine a sports car or villa ‚Äî pick wisely üòâ",
  "The family is watching ‚Äî who gets the glory?",
  "Final stretch! Give it everything you've got!"
];

// ---------- FAMILY ----------
const FAMILY = [
  {id:'mom', name:'Mom'}, {id:'dad', name:'Dad'}, {id:'sibling', name:'Sibling'}, {id:'cousin', name:'Cousin'}, {id:'friend1', name:'Friend 1'}, {id:'friend2', name:'Friend 2'}
];

// ---------- SOUND HELPERS ----------
function ensureAudio(){ if(audioCtx) return; audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
function playBeep(freq=440, dur=90, type='sine', vol=0.07){ try{ ensureAudio(); const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type=type; o.frequency.value=freq; g.gain.value=vol; o.connect(g); g.connect(audioCtx.destination); o.start(); setTimeout(()=>{ o.stop(); }, dur); }catch(e){console.log(e);} }
function playClick(){ playBeep(880,50,'square',0.04); }
function playCorrect(){ playBeep(880,90); setTimeout(()=>playBeep(1100,110),90); }
function playIncorrect(){ playBeep(180,220,'sawtooth',0.09); }
function playDeal(){ playBeep(1000,130); setTimeout(()=>playBeep(760,120),120); }
function playNoDeal(){ playBeep(240,80); setTimeout(()=>playBeep(280,80),90); }
function playWin(){ for(let i=0;i<5;i++){ setTimeout(()=>playBeep(700 + i*100,140), i*120); } }

// ---------- CHART ----------
let chart = null;
function initChart(){ const ctx = document.getElementById('prizeChart').getContext('2d'); chart = new Chart(ctx, { type: 'line', data: { labels: Array.from({length:10}, (_,i)=>'Q'+(i+1)), datasets:[{label:'Prize ($)',data:Array(10).fill(0),fill:false,borderColor:'#06b6d4',backgroundColor:'#7c3aed',tension:0.3,pointRadius:6}] }, options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true}}} }); }
function updateChart(){ if(!chart) return; const data = chart.data.datasets[0].data; for(let i=0;i<10;i++){ data[i] = prizeProgress[i] || 0; } chart.update(); }

// ---------- UTILS ----------
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}}

// ---------- QUESTION POOL (curated + programmatic to reach 250) ----------
const POOL = [
  // Curated questions (a good chunk taken/expanded from your earlier lists)
  {q:"what prime number comes after 47?", a:"53", hint:"it's between 50 and 55"},
  {q:"what is the chemical symbol for gold?", a:"au", hint:"same as 'aurum'"},
  {q:"in degrees, what's the sum of interior angles of a triangle?", a:"180", hint:"a straight line"},
  {q:"which planet is known as the red planet?", a:"mars", hint:"roman god of war"},
  {q:"what is the square root of 144?", a:"12", hint:"dozen"},
  {q:"what large language family does spanish belong to?", a:"indo-european", hint:"same family as english"},
  {q:"the capital of canada is?", a:"ottawa", hint:"not toronto"},
  {q:"who painted the mona lisa?", a:"leonardo da vinci", hint:"italian renaissance man"},
  {q:"what is h2o commonly called?", a:"water", hint:"essential for life"},
  {q:"what city hosts the statue of liberty (country)?", a:"united states", hint:"country: usa"},
  {q:"who proposed the theory of relativity (last name)?", a:"einstein", hint:"famous physicist with wild hair"},
  {q:"what is the center of an atom called?", a:"nucleus", hint:"contains protons"},
  {q:"which gas do plants primarily absorb?", a:"carbon dioxide", hint:"co2"},
  {q:"in music, how many semitones in an octave?", a:"12", hint:"western chromatic scale"},
  {q:"what animal is the largest living land mammal?", a:"elephant", hint:"long trunk"},
  {q:"who wrote 'romeo and juliet'?", a:"shakespeare", hint:"bard"},
  {q:"what is the value of pi rounded to two decimals?", a:"3.14", hint:"approximation"},
  {q:"what is the hardest natural substance?", a:"diamond", hint:"often used in engagement rings"},
  {q:"which element has atomic number 1?", a:"hydrogen", hint:"the lightest"},
  {q:"what is 7 factorial (7!)?", a:"5040", hint:"7*6*5*4*3*2*1"},
  {q:"the longest river in the world - commonly named?", a:"nile", hint:"flows through egypt"},
  {q:"what temperature does water freeze in celsius?", a:"0", hint:"less than 1"},
  {q:"which language has the most native speakers?", a:"mandarin", hint:"a chinese language"},
  {q:"what is the smallest prime number?", a:"2", hint:"only even prime"},
  {q:"what geometric shape has three sides?", a:"triangle", hint:"three"},
  {q:"what organ pumps blood around the body?", a:"heart", hint:"symbol of love"},
  {q:"who discovered penicillin (last name)?", a:"fleming", hint:"alexander ____"},
  {q:"what is the chemical formula for table salt?", a:"nacl", hint:"sodium chloride"},
  {q:"who was the first president of the united states?", a:"george washington", hint:"crossed the delaware"},
  {q:"what is the study of cells called?", a:"cytology", hint:"cyto-"},
  {q:"what fruit is the main ingredient in guacamole?", a:"avocado", hint:"green and creamy"},
  {q:"what is 2 to the 10th power?", a:"1024", hint:"just over 1000"},
  {q:"what is the capital of japan?", a:"tokyo", hint:"hosted 2020 olympics"},
  {q:"which metal is liquid at room temperature?", a:"mercury", hint:"used in old thermometers"},
  {q:"what mythical creature breathes fire in many stories?", a:"dragon", hint:"often hoards gold"},
  {q:"who wrote the iliad and the odyssey (traditional attribution)?", a:"homer", hint:"ancient greek poet"},
  {q:"what is the freezing point of water in fahrenheit?", a:"32", hint:"32¬∞f"},
  {q:"which organelle is the 'powerhouse' of the cell?", a:"mitochondrion", hint:"produces atp"},
  {q:"what is the chemical symbol for oxygen?", a:"o", hint:"gas we breathe"},
  {q:"which planet has the most moons (as of 2025)?", a:"jupiter", hint:"largest planet"},
  {q:"what artistic movement is picasso associated with?", a:"cubism", hint:"fragmented forms"},
  {q:"what is the capital of australia?", a:"canberra", hint:"not sydney"},
  {q:"what does 'www' stand for?", a:"world wide web", hint:"internet prefix"},
  {q:"who is known as the father of modern computing (turing or von neumann)?", a:"turing", hint:"turing test"},
  {q:"what is the study of the past called?", a:"history", hint:"what happened before"},
  {q:"what sweetener is made from bees?", a:"honey", hint:"not maple"},
  {q:"what is a group of lions called?", a:"pride", hint:"royal group"},
  {q:"who painted the starry night?", a:"vincent van gogh", hint:"post-impressionist"},
  {q:"what device measures atmospheric pressure?", a:"barometer", hint:"predicts weather"},
  {q:"what number is represented by the roman numeral 'x'?", a:"10", hint:"two fives"},
  {q:"what is the capital of france?", a:"paris", hint:"city of lights"},
  {q:"which gas makes up most of earth's atmosphere?", a:"nitrogen", hint:"about 78%"},
  {q:"what is the currency of the united kingdom?", a:"pound sterling", hint:"abbrev: gbp"},
  {q:"what is 11 * 11?", a:"121", hint:"11 squared"},
  {q:"what is the primary component of natural gas?", a:"methane", hint:"ch4"},
  {q:"what mammal lays eggs?", a:"platypus", hint:"a monotreme"},
  {q:"who created sherlock holmes?", a:"arthur conan doyle", hint:"british author"},
  {q:"what is the capital of italy?", a:"rome", hint:"colosseum"},
  {q:"what is the term for a polygon with five sides?", a:"pentagon", hint:"five"},
  {q:"what fundamental force holds nuclei together?", a:"strong force", hint:"one of four forces"},
  {q:"what is the highest mountain above sea level?", a:"mount everest", hint:"nepal/china border"},
  {q:"what is the primary language of brazil?", a:"portuguese", hint:"not spanish"},
  {q:"what instrument measures earthquakes?", a:"seismometer", hint:"seismic waves"},
  {q:"who is the author of 'a brief history of time'?", a:"stephen hawking", hint:"black holes"},
  {q:"what color do you get by mixing red and blue (paint)?", a:"purple", hint:"royal color"},
  {q:"what is the chemical symbol for iron?", a:"fe", hint:"from ferrum"},
  {q:"who was the british prime minister during ww2?", a:"winston churchill", hint:"v for victory"},
  {q:"what is the square of 15?", a:"225", hint:"15*15"},
  {q:"what is the fastest land animal?", a:"cheetah", hint:"spotted sprint"},
  {q:"which festival is celebrated with lanterns in china?", a:"mid autumn festival", hint:"mooncakes"},
  {q:"what is the lightest noble gas?", a:"helium", hint:"used in balloons"},
  {q:"what is the capital of egypt?", a:"cairo", hint:"pyramids nearby"},
  {q:"what is the primary ingredient in traditional sushi vinegared rice aside from rice?", a:"rice vinegar", hint:"seasoning"},
  {q:"who built the model of universal gravitation (last name)?", a:"newton", hint:"apple story"},
  {q:"what is 13 + 24?", a:"37", hint:"sum under 40"},
  {q:"what chemical element is represented by 'na'?", a:"sodium", hint:"salt"},
  {q:"which country has the city named kyoto?", a:"japan", hint:"historic capital"},
  {q:"in computing, what does 'cpu' stand for?", a:"central processing unit", hint:"brain of the computer"},
  {q:"what is the study of weather called?", a:"meteorology", hint:"forecasts"},
  {q:"what breed is known as the 'king of dogs' in the tibet region?", a:"tibetan mastiff", hint:"large guardian"},
  {q:"who is the author of the hobbit?", a:"j r r tolkien", hint:"middle-earth"},
  {q:"what is the atomic number of carbon?", a:"6", hint:"atomic number small"},
  {q:"which composer wrote the 'fifth symphony'?", a:"beethoven", hint:"famous motif"},
  {q:"what year did the berlin wall fall?", a:"1989", hint:"end of cold war era"},
  {q:"what spice is derived from dried stigma of crocus sativus?", a:"saffron", hint:"expensive spice"},
  {q:"what is the study of insects called?", a:"entomology", hint:"bugs"},
  {q:"which ocean is the largest?", a:"pacific", hint:"vast and deep"},
  {q:"what is the value of 0! (zero factorial)?", a:"1", hint:"by definition"},
  {q:"what is the capital of russia?", a:"moscow", hint:"kremlin"},
  {q:"what mammal can fly?", a:"bat", hint:"uses echolocation"},
  {q:"which artist is known for the 'persistence of memory' clocks?", a:"salvador dali", hint:"surrealist"},
  {q:"what city is famous for tango and beef, capital of argentina?", a:"buenos aires", hint:"latin america"},
  {q:"what is the term for speed of light in vacuum (symbol c) approx km/s?", a:"299792", hint:"~3e5 km/s"},
  {q:"who was the first woman to fly solo across the atlantic?", a:"amelia earhart", hint:"disappeared over pacific"},
  {q:"what is the smallest continent by land area?", a:"australia", hint:"continent-country"},
  {q:"what color are chloroplasts typically?", a:"green", hint:"contain chlorophyll"},
  {q:"what is the capital of turkey?", a:"ankara", hint:"not istanbul"},
  {q:"which novelist wrote '1984'?", a:"george orwell", hint:"dystopia"},
  {q:"what kind of bond involves sharing electron pairs?", a:"covalent", hint:"molecule-level bond"},
  {q:"what is the chemical formula for ozone?", a:"o3", hint:"three oxygens"},
  {q:"who was assassinated in 1963 in dallas?", a:"john f kennedy", hint:"american president"},
  {q:"what is the metric unit of mass?", a:"kilogram", hint:"kg"},
  {q:"what country invented pizza?", a:"italy", hint:"naples"},
  {q:"what is the largest organ in the human body?", a:"skin", hint:"protective covering"},
  {q:"what is the symbol for pi in greek alphabet?", a:"pi", hint:"œÄ"},
  {q:"who discovered electricity with experiments using kites?", a:"benjamin franklin", hint:"founding father"},
  {q:"what geometric solid has 6 faces all squares?", a:"cube", hint:"all edges equal"},
  {q:"what is the name of the galaxy we live in?", a:"milky way", hint:"spiral galaxy"},
  {q:"what is the process plants use to make food from sunlight?", a:"photosynthesis", hint:"light energy"},
  {q:"which city is known as the eternal city?", a:"rome", hint:"ancient empire"},
  {q:"what is the largest internal organ in humans?", a:"liver", hint:"detoxifies"},
  {q:"who painted the ceiling of the sistine chapel?", a:"michelangelo", hint:"also sculpted david"},
  {q:"what metal is used to make bronze (alloy of copper and ...)?", a:"tin", hint:"bronze = copper + ?"},
  {q:"what is the common name for sodium bicarbonate?", a:"baking soda", hint:"used in baking"},
  {q:"which element is used to sterilize water and is in pools?", a:"chlorine", hint:"keeps pools safe"},
  {q:"what is the capital of india?", a:"new delhi", hint:"not mumbai"},
  {q:"who wrote the novel 'frankenstein'?", a:"mary shelley", hint:"published 1818"},
  {q:"what is the main ingredient in hummus?", a:"chickpeas", hint:"also called garbanzo"},
  {q:"what is the chemical symbol for potassium?", a:"k", hint:"bananas contain it"},
  {q:"what is the name of the longest bone in the human body?", a:"femur", hint:"thigh bone"},
  {q:"which country has the most time zones (including overseas territories)?", a:"france", hint:"many overseas departments"},
  {q:"what is the name of the pigment that makes plants green?", a:"chlorophyll", hint:"absorbs light"},
  {q:"what is the art of paper folding called?", a:"origami", hint:"japanese tradition"},
  {q:"what is the capital of mexico?", a:"mexico city", hint:"largest city in mexico"},
  {q:"what is 9 squared?", a:"81", hint:"9*9"},
  {q:"what famous physicist developed quantum mechanics contributions and has a namesake uncertainty principle?", a:"heisenberg", hint:"uncertainty"},
  {q:"what is the national flower of japan?", a:"cherry blossom", hint:"sakura"},
  {q:"which novel begins with 'call me ishmael'?,", a:"moby dick", hint:"whale"},
  {q:"what is the process of cell division producing gametes called?", a:"meiosis", hint:"halves chromosome number"},
  {q:"what is the chemical that makes chili peppers hot?", a:"capsaicin", hint:"in spicy peppers"},
  {q:"what currency uses the symbol '‚Ç¨'?", a:"euro", hint:"used in many european countries"},
  {q:"which instrument has keys, pedals, and strings struck by hammers?", a:"piano", hint:"concert instrument"},
  {q:"who is the author of 'to kill a mockingbird'?", a:"harper lee", hint:"atticus finch"},
  {q:"what bird is a national symbol of the united states?", a:"bald eagle", hint:"white head"},
  {q:"what mathematician is famous for a last theorem proved by andrew wiles?", a:"fermat", hint:"little theorem?"},
  {q:"what is the chemical formula for carbon dioxide?", a:"co2", hint:"exhaled gas"},
  {q:"what is the primary ingredient in traditional paella besides rice?", a:"saffron", hint:"gives yellow color"},
  {q:"which author wrote 'the catcher in the rye'", a:"j d salinger", hint:"holden caulfield"},
  {q:"what is the capital of south africa (one of the three)?", a:"cape town", hint:"legislative capital"}
  // (we'll add programmatically-generated questions next to reach 250)
];

// ---------- Programmatically add extra questions to reach 250 ----------
(function extendPoolTo250(){
  const baseLen = POOL.length;
  const target = 250;
  let i = 0;
  while(POOL.length < target){
    i++;
    // generate arithmetic / trivia variants to expand the pool
    // produce mix of math, simple facts, and fun trivia
    if(i % 5 === 0){
      // small math
      const a = (i*3 + 7) % 97;
      const b = (i*5 + 11) % 89;
      const q = `what is ${a} + ${b}?`;
      const aAns = (a + b).toString();
      POOL.push({q:q, a:aAns, hint:'add the two numbers'});
    } else if(i % 5 === 1){
      // multiplication
      const a = (i % 12) + 2;
      const b = ((i*2) % 11) + 2;
      const q = `what is ${a} * ${b}?`;
      POOL.push({q:q, a:(a*b).toString(), hint:'multiply the two numbers'});
    } else if(i % 5 === 2){
      // months / calendar
      const months = ['january','february','march','april','may','june','july','august','september','october','november','december'];
      const idx = (i*7) % 12;
      POOL.push({q:`which month is number ${idx+1}?`, a:months[idx], hint:'month by number'});
    } else if(i % 5 === 3){
      // countries capitals variants (simple)
      const caps = [
        ['lisbon','portugal'],['bern','switzerland'],['oslo','norway'],['helsinki','finland'],['vienna','austria'],
        ['athens','greece'],['zagreb','croatia'],['prague','czech republic'],['brussels','belgium'],['vienna','austria']
      ];
      const pick = caps[i % caps.length];
      POOL.push({q:`what is the capital of ${pick[1]}?`, a:pick[0], hint:'capital city'});
    } else {
      // odd/fun facts
      const facts = [
        {q:'what fruit shares its name with a color?', a:'orange', hint:'looks like its name'},
        {q:'what animal purrs when content?', a:'cat', hint:'common pet'},
        {q:'what is the opposite of hot?', a:'cold', hint:'temperature antonym'},
        {q:'what do bees make?', a:'honey', hint:'sweet spread'},
        {q:'what is 1 + 1?', a:'2', hint:'basic addition'}
      ];
      const pick = facts[i % facts.length];
      POOL.push({q:pick.q, a:pick.a, hint:pick.hint});
    }
    if(POOL.length >= target) break;
  }
})();

// ---------- PICK QUESTIONS (10 per run) ----------
function pickQuestions(){
  const copy = POOL.slice();
  shuffle(copy);
  const selected = [];
  for(let i=0;i<10;i++){
    const biasStart = Math.floor((i/10) * (copy.length*0.6));
    const pickIndex = biasStart + Math.floor(Math.random() * Math.max(1, Math.floor(copy.length*0.4)));
    selected.push(copy[pickIndex % copy.length]);
  }
  return selected;
}

// ---------- FAMILY ADVICE ----------
function familyAdvice(prize, stage){
  const adv = [];
  FAMILY.forEach((m, idx)=>{
    let text='';
    if(prize <= 3500) text = "Don't take the deal ‚Äî keep going! üí™";
    else if(prize <= 14000) text = (idx%2===0) ? "You're close, maybe think about it... ü§î" : "Keep going, you got this!";
    else if(prize <= 50000) text = "This is getting big ‚Äî consider taking the deal! üò¨";
    else text = "Take the deal now! Cash out! ü§ë";
    if(stage === 'deal' && prize >= 20000) text = "Take the deal ‚Äî safely cash out! üè¶";
    adv.push({member:m.name, text});
  });
  return adv;
}
function renderFamily(prize, stage){
  const panel = document.getElementById('familyPanel'); panel.innerHTML='';
  const adv = familyAdvice(prize, stage);
  adv.forEach(a=>{
    const d = document.createElement('div'); d.className='bubble'; d.innerHTML = `<strong>${a.member}</strong><div>${a.text}</div>`; panel.appendChild(d);
  });
}

// ---------- HOST SPEAK ----------
function hostSpeak(line){
  const el = document.getElementById('hostLine'); el.textContent = line;
  setTimeout(()=>{ playClick(); }, 60);
}

// ---------- CONFETTI ----------
function triggerConfetti(){ const C = document.getElementById('confetti'); const emojis = ['üéâ','üéä','üèÜ','üí∞','‚ú®','üöó','üèùÔ∏è']; for(let i=0;i<42;i++){ const s = document.createElement('span'); s.textContent = emojis[Math.floor(Math.random()*emojis.length)]; s.style.left = (Math.random()*100)+'%'; s.style.fontSize = (12 + Math.random()*36) + 'px'; s.style.animationDuration = (2200 + Math.random()*2000)+'ms'; C.appendChild(s); setTimeout(()=>{ s.remove(); }, 5000); } }

// ---------- UI UPDATE ----------
function updateUI(){
  document.getElementById('current').textContent = Math.min(currentIndex+1, questions.length);
  document.getElementById('correctCount').textContent = correctCount;
  const prizeNow = PRIZE_MAP[correctCount] || 0;
  document.getElementById('currentPrize').textContent = "$"+prizeNow.toLocaleString();
  const pct = Math.round((currentIndex/10)*100);
  document.getElementById('progressBar').style.width = pct + '%';
  document.getElementById('hintsLeft').textContent = hintsLeft;
  document.getElementById('retriesLeft').textContent = retriesLeft;
}

// ---------- SHOW QUESTION ----------
function showQuestion(){
  if(currentIndex >= questions.length){ endGame(); return; }
  const q = questions[currentIndex];
  document.getElementById('qnum').textContent = 'Question '+(currentIndex+1);
  document.getElementById('question').textContent = q.q + ' üîé';
  document.getElementById('answerReveal').style.display='none';
  document.getElementById('status').textContent='';
  document.getElementById('answerInput').value='';
  document.getElementById('phoneArea').style.display='none';
  updateUI();
  const hostLine = HOST_LINES[Math.floor(Math.random()*HOST_LINES.length)];
  hostSpeak(hostLine);
  renderFamily(prizeProgress[currentIndex] || 0, 'after');
}

// ---------- HOST TEMPTATION (Q5-8) ----------
function hostTemptation(){
  if(currentIndex+1 >=5 && currentIndex+1 <=8){
    const temptations = [
      "Imagine a sports car in your driveway ‚Äî cash out now and go for a spin!",
      "A luxury villa in the sun ‚Äî we could make that happen today.",
      "A dream vacation for your whole family ‚Äî take the deal and fly!",
      "A shiny collection of tech and a safe bank deposit ‚Äî consider it!"
    ];
    const txt = temptations[Math.floor(Math.random()*temptations.length)];
    hostSpeak("Host: " + txt);
    document.getElementById('dealText').textContent = `Tempting offer: ${txt} ‚Äî bank offers $${(PRIZE_MAP[correctCount] || 0).toLocaleString()}.`;
    document.getElementById('dealArea').style.display = 'block';
  }
}

// ---------- OFFER DEAL ----------
function offerDeal(){
  const offer = PRIZE_MAP[correctCount] || 0;
  const dealText = offer>0 ? `Banker offers: $${offer.toLocaleString()}. Take the deal?` : 'Banker offers $0.';
  document.getElementById('dealText').textContent = dealText;
  document.getElementById('dealArea').style.display='block';
  renderFamily(offer, 'deal');
  hostSpeak(`Host: Banker offers $${offer.toLocaleString()}. What will you do?`);
}

// ---------- HIDE DEAL ----------
function hideDeal(){ document.getElementById('dealArea').style.display='none'; }

// ---------- END GAME ----------
function endGame(finalDealAmount){
  gameOver=true;
  document.getElementById('question').textContent = 'Game over üéâ';
  document.getElementById('qnum').textContent='';
  document.getElementById('answerInput').disabled=true;
  document.getElementById('submitBtn').disabled=true;
  hideDeal();
  document.getElementById('restartBtn').style.display='block';
  let finalText='';
  if(finalDealAmount){
    finalText = `You accepted the deal and won $${finalDealAmount.toLocaleString()} üéâ`;
  } else {
    const finalPrize = PRIZE_MAP[correctCount] || 0;
    finalText = `You finished. Correct: ${correctCount}. Prize: $${finalPrize.toLocaleString()}.`;
  }
  document.getElementById('status').textContent = finalText;
  hostSpeak("Host: " + finalText + " Congratulations!");
  if((PRIZE_MAP[correctCount] || 0) > 0 || finalDealAmount){
    triggerConfetti();
    playWin();
  }
}

// ---------- SUBMIT ANSWER (with Retry support) ----------
let lastAttemptWrong = false;
function submitAnswer(){
  if(gameOver) return;
  const raw = document.getElementById('answerInput').value.trim();
  if(!raw) return;
  const ans = raw.toLowerCase();
  const q = questions[currentIndex];
  playClick();
  // correct
  if(ans === (q.a + '').toLowerCase()){
    correctCount++;
    const prizeNow = PRIZE_MAP[correctCount] || 0;
    prizeProgress[currentIndex] = prizeNow;
    document.getElementById('status').textContent = `Correct! ‚úÖ You now have $${prizeNow.toLocaleString()}`;
    playCorrect();
    hostSpeak("Host: You're on fire! What would you do with the money?");
    lastAttemptWrong = false;
    currentIndex++;
    updateUI();
    updateChart();
    // temptation / deal
    setTimeout(()=>{
      if(currentIndex < questions.length){
        if(currentIndex+1 >=5 && currentIndex+1 <=8) hostTemptation();
        else offerDeal();
      } else {
        endGame();
      }
    }, 420);
    return;
  }

  // first wrong and retry available (automatic)
  if(retriesLeft > 0 && !lastAttemptWrong){
    retriesLeft--;
    lastAttemptWrong = true;
    document.getElementById('status').textContent = `Incorrect ‚Äî but you used a Retry! Try the question again. Retries left: ${retriesLeft}`;
    document.getElementById('retriesLeft').textContent = retriesLeft;
    playClick();
    hostSpeak("Host: You used your retry ‚Äî go again!");
    return; // allow second attempt on same question
  }

  // otherwise wrong permanently
  document.getElementById('status').textContent = 'Incorrect ‚ùå ‚Äî you lost your accumulated prize. Restart or keep playing to rebuild.';
  document.getElementById('answerReveal').style.display='block';
  document.getElementById('answerReveal').textContent = 'Answer: ' + q.a + ' üîí';
  playIncorrect();
  hostSpeak("Host: Tough break! That one got away.");
  // reset progress
  correctCount = 0;
  prizeProgress[currentIndex] = 0;
  for(let i=currentIndex+1;i<10;i++) prizeProgress[i] = 0;
  updateChart();
  document.getElementById('restartBtn').style.display='block';
  renderFamily(0,'after');
  // move on after short pause
  currentIndex++;
  updateUI();
  setTimeout(()=>{ offerDeal(); }, 420);
}

// ---------- HINT ----------
function useHint(){
  if(gameOver) return;
  if(hintsLeft <= 0){ alert('No hints left'); return; }
  const q = questions[currentIndex];
  hintsLeft--;
  document.getElementById('hintsLeft').textContent = hintsLeft;
  document.getElementById('status').textContent = 'Hint: ' + q.hint + ' üí°';
  playClick();
  hostSpeak("Host: I've given you a hint.");
}

// ---------- PHONE-A-FRIEND ----------
function showPhoneChoices(){
  if(gameOver) return;
  const wrap = document.getElementById('phoneChoices'); wrap.innerHTML='';
  FAMILY.forEach(f=>{
    const b = document.createElement('button');
    b.className = 'secondary';
    b.textContent = f.name;
    b.addEventListener('click', ()=>{ callFriend(f); });
    wrap.appendChild(b);
  });
  document.getElementById('phoneArea').style.display='block';
  document.getElementById('phoneResponse').style.display='none';
  hostSpeak("Host: Who would you like to call?");
}
function callFriend(f){
  if(gameOver) return;
  if(usedPhone){ document.getElementById('phoneResponse').style.display='block'; document.getElementById('phoneResponse').textContent = `${f.name}: I already helped you this game.`; return; }
  usedPhone = true;
  const q = questions[currentIndex];
  const baseChance = 0.25 + Math.random()*0.45; // 25% to 70% chance of being accurate
  const willBeRight = Math.random() < baseChance;
  let response='';
  if(willBeRight){
    response = `${f.name}: Hmm ‚Äî I think the answer might be "${q.a}". I'm pretty sure about this.`;
  } else {
    // partial or wrong guess ‚Äî sometimes a hint-like guess
    const guess = (typeof q.a === 'string' && q.a.length>3) ? q.a.slice(0, Math.max(2, Math.floor(q.a.length/2))) + '...' : q.a;
    const hedge = Math.random() < 0.5 ? "Not 100% sure, but maybe" : "I might be wrong, but";
    // vary the phrasing by family member
    const tone = (f.id==='mom' || f.id==='dad') ? `${hedge} "${guess}" ‚Äî sounds familiar.` : `${hedge} "${guess}" ‚Äî could be it.`;
    response = `${f.name}: ${tone}`;
  }
  document.getElementById('phoneResponse').style.display='block';
  document.getElementById('phoneResponse').textContent = response;
  playClick();
  hostSpeak(`Host: ${f.name} says "${willBeRight ? 'I think that is correct!' : 'I\'m unsure...' }"`);
}

// ---------- DEAL / NO DEAL ----------
function takeDeal(){ if(gameOver) return; const offer = PRIZE_MAP[correctCount] || 0; playDeal(); hideDeal(); endGame(offer); }
function noDeal(){ if(gameOver) return; playNoDeal(); hideDeal(); if(currentIndex < questions.length) showQuestion(); }

// ---------- RESTART ----------
function restartGame(){
  document.getElementById('restartBtn').style.display='none';
  questions = pickQuestions();
  currentIndex = 0; correctCount = 0; hintsLeft = 2; retriesLeft = 1; usedPhone=false; gameOver = false;
  prizeProgress = Array(10).fill(0);
  document.getElementById('hintsLeft').textContent = hintsLeft;
  document.getElementById('retriesLeft').textContent = retriesLeft;
  document.getElementById('answerInput').disabled=false; document.getElementById('submitBtn').disabled=false;
  updateChart(); updateUI(); showQuestion(); renderFamily(0,'after');
  document.getElementById('phoneArea').style.display='none';
}

// ---------- WIRING ----------
document.getElementById('submitBtn').addEventListener('click', submitAnswer);
document.getElementById('hintBtn').addEventListener('click', useHint);
document.getElementById('retryBtn').addEventListener('click', ()=>{
  if(gameOver) return;
  if(retriesLeft <= 0){ alert('No retries left'); return; }
  // proactive reservation: consume retries and allow one extra wrong later
  retriesLeft--; document.getElementById('retriesLeft').textContent = retriesLeft;
  lastAttemptWrong = false;
  document.getElementById('status').textContent = 'Retry reserved ‚Äî if you answer wrong, you will get one more attempt.';
  hostSpeak("Host: Retry activated ‚Äî don't waste it!");
  playClick();
});
document.getElementById('phoneBtn').addEventListener('click', showPhoneChoices);
document.getElementById('dealBtn').addEventListener('click', takeDeal);
document.getElementById('noDealBtn').addEventListener('click', noDeal);
document.getElementById('restartBtn').addEventListener('click', restartGame);
document.getElementById('answerInput').addEventListener('keydown',(e)=>{ if(e.key==='Enter') submitAnswer(); });

// ---------- START / RULES ----------
document.getElementById('startBtn').addEventListener('click', ()=>{
  ensureAudio();
  document.getElementById('answerInput').disabled=false;
  document.getElementById('submitBtn').disabled=false;
  document.getElementById('startOverlay').style.display='none';
  initGame();
  playBeep(440,120);
});
document.getElementById('viewRules').addEventListener('click', ()=>{ alert('Rules:\\n- Type answers in lowercase.\\n- Two regular hints total.\\n- One Retry total per game (use proactively or use after wrong answer).\\n- One Phone-a-Friend call per game.\\n- Wrong twice on a question resets your accumulated prize to $0.\\n- Host and family will react and may offer deals.'); });

// ---------- INIT GAME ----------
function initGame(){
  if(!chart) initChart();
  questions = pickQuestions();
  currentIndex = 0; correctCount = 0; hintsLeft = 2; retriesLeft = 1; usedPhone=false; gameOver=false;
  prizeProgress = Array(10).fill(0); document.getElementById('hintsLeft').textContent = hintsLeft;
  document.getElementById('answerInput').value=''; document.getElementById('answerInput').focus();
  updateUI(); updateChart(); showQuestion(); renderFamily(0,'after');
  hostSpeak("Host: Let's play ‚Äî good luck!");
}

// ---------- ON LOAD PREP ----------
(function(){
  document.getElementById('status').textContent = 'Click Start to enable sounds and begin your challenge! üéµ';
  prizeProgress = Array(10).fill(0);
  initChart(); updateChart(); renderFamily(0,'after');
  hostSpeak("Host: Welcome! Press Start to begin.");
})();
</script>
</body>
</html>
